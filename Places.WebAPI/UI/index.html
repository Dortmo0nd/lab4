<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Places App</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
<header class="bg-blue-600 text-white p-4">
    <h1 class="text-2xl font-bold">Places App</h1>
</header>
<main class="flex-grow container mx-auto p-4">
    <!-- Form to Add a Place -->
    <section class="mb-8 bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-xl font-semibold mb-4">Add a New Place</h2>
        <div class="grid grid-cols-1 gap-4">
            <input type="text" id="placeName" placeholder="Name" class="border p-2 rounded" required>
            <textarea id="placeDescription" placeholder="Description" class="border p-2 rounded" rows="4"></textarea>
            <input type="number" id="placeLatitude" placeholder="Latitude" class="border p-2 rounded" step="any" required>
            <input type="number" id="placeLongitude" placeholder="Longitude" class="border p-2 rounded" step="any" required>
            <button onclick="addPlace()" class="bg-blue-500 text-white p-2 rounded hover:bg-blue-600">Add Place</button>
        </div>
    </section>

    <!-- List of Places -->
    <section>
        <h2 class="text-xl font-semibold mb-4">Places List</h2>
        <div id="placesList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </section>
</main>
<footer class="bg-gray-800 text-white p-4 text-center">
    <p>&copy; 2025 Places App</p>
</footer>

<script>
    const apiUrl = 'http://localhost:5015/api/places';

    // Fetch and display all places
    async function fetchPlaces() {
        try {
            const response = await fetch(apiUrl);
            const places = await response.json();
            const placesList = document.getElementById('placesList');
            placesList.innerHTML = '';
            places.forEach(place => {
                const placeCard = document.createElement('div');
                placeCard.className = 'bg-white p-4 rounded-lg shadow-md';
                placeCard.innerHTML = `
                        <h3 class="text-lg font-bold">${place.name}</h3>
                        <p>${place.description || 'No description'}</p>
                        <p>Latitude: ${place.latitude}</p>
                        <p>Longitude: ${place.longitude}</p>
                        <button onclick="deletePlace(${place.id})" class="bg-red-500 text-white p-2 rounded mt-2 hover:bg-red-600">Delete</button>
                    `;
                placesList.appendChild(placeCard);
            });
        } catch (error) {
            console.error('Error fetching places:', error);
            alert('Failed to load places');
        }
    }

    // Add a new place
    async function addPlace() {
        const name = document.getElementById('placeName').value;
        const description = document.getElementById('placeDescription').value;
        const latitude = parseFloat(document.getElementById('placeLatitude').value);
        const longitude = parseFloat(document.getElementById('placeLongitude').value);

        if (!name || isNaN(latitude) || isNaN(longitude)) {
            alert('Please fill in all required fields');
            return;
        }

        const place = { name, description, latitude, longitude };

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(place)
            });
            if (response.ok) {
                document.getElementById('placeName').value = '';
                document.getElementById('placeDescription').value = '';
                document.getElementById('placeLatitude').value = '';
                document.getElementById('placeLongitude').value = '';
                fetchPlaces();
            } else {
                alert('Failed to add place');
            }
        } catch (error) {
            console.error('Error adding place:', error);
            alert('Failed to add place');
        }
    }

    // Delete a place
    async function deletePlace(id) {
        if (!confirm('Are you sure you want to delete this place?')) return;

        try {
            const response = await fetch(`${apiUrl}/${id}`, {
                method: 'DELETE'
            });
            if (response.ok) {
                fetchPlaces();
            } else {
                alert('Failed to delete place');
            }
        } catch (error) {
            console.error('Error deleting place:', error);
            alert('Failed to delete place');
        }
    }

    // Initial fetch of places
    fetchPlaces();
</script>
</body>
</html>